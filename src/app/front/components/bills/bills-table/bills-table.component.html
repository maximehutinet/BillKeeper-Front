<p-table [value]="tableRows" stripedRows>
  <ng-template #header>
    <tr>
      @if (makeBillSelectable) {
        <th>
          <p-checkbox [(ngModel)]="allRowsSelected" (onChange)="onAllRowsSelected()" [binary]="true"/>
        </th>
      }

      <th pSortableColumn="bill.serviceDateTime">Date of Service
        <p-sortIcon field="bill.serviceDateTime"/>
      </th>
      <th>Name</th>
      <th>Amount</th>
      <th pSortableColumn="bill.beneficiary.firstname">Beneficiary
        <p-sortIcon field="bill.beneficiary.firstname"/>
      </th>
      <th pSortableColumn="bill.status">Status
        <p-sortIcon field="bill.status"/>
      </th>
      <th></th>
    </tr>
  </ng-template>
  <ng-template #body let-row>
    <tr>
      @if (makeBillSelectable) {
        <td class="td-checkbox">
          <p-checkbox [(ngModel)]="row.checked" (onChange)="onCheckboxChange()" [binary]="true"/>
        </td>
      }

      <td [routerLink]="'/bill/' + row.bill.id" [queryParams]="submissionViewParamActive ? { submissionView: true } : null">
        <app-value-loading-or-ns [value]="row.bill.serviceDateTime" [loading]="row.bill.parsingJobStatus === ParsingJobStatus.IN_PROGRESS">
          {{ row.bill.serviceDateTime | date: 'longDate' }}
        </app-value-loading-or-ns>
      </td>
      <td [routerLink]="'/bill/' + row.bill.id" [queryParams]="submissionViewParamActive ? { submissionView: true } : null">
        <app-value-loading-or-ns [value]="row.bill.name" [loading]="row.bill.parsingJobStatus === ParsingJobStatus.IN_PROGRESS">
          {{ row.bill.name }}
        </app-value-loading-or-ns>
      </td>
      <td [routerLink]="'/bill/' + row.bill.id" [queryParams]="submissionViewParamActive ? { submissionView: true } : null">
        <app-value-loading-or-ns [value]="row.bill.amount" [loading]="row.bill.parsingJobStatus === ParsingJobStatus.IN_PROGRESS">
          {{ row.bill.amount | currency:row.bill.currency }}
        </app-value-loading-or-ns>
      </td>
      <td [routerLink]="'/bill/' + row.bill.id" [queryParams]="submissionViewParamActive ? { submissionView: true } : null">
        <app-value-loading-or-ns [value]="row.bill.beneficiary?.firstname" [loading]="row.bill.parsingJobStatus === ParsingJobStatus.IN_PROGRESS">
          {{ row.bill.beneficiary?.firstname }}
        </app-value-loading-or-ns>
      </td>
      <td [routerLink]="'/bill/' + row.bill.id" [queryParams]="submissionViewParamActive ? { submissionView: true } : null">
        <app-bill-status-badge [bill]="row.bill"></app-bill-status-badge>
      </td>
      <td class="bill-action">
        <p-menu #menu [model]="row.menuItems" [popup]="true" appendTo="body"/>
        <p-button (click)="menu.toggle($event)" icon="pi pi-ellipsis-v" severity="secondary" />
      </td>
    </tr>
  </ng-template>
</p-table>
